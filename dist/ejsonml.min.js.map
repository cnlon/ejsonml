{"version":3,"file":"ejsonml.min.js","sources":["../node_modules/ejsonml-render/src/index.js"],"sourcesContent":["export default function render (ejml, scope, global, subScope) {\n  let res\n  if (!ejml) {\n    res = ''\n  } else if (Array.isArray(ejml)) {\n    let [node, attributes, ...children] = ejml\n    if (node === '*') {\n      node = createFragment(node)\n      computedAttributes(attributes, scope, global, subScope, (sub) => {\n        appendChildren(node, children, scope, global, sub)\n      })\n    } else {\n      node = createNode(node)\n      setAttributes(node, attributes, scope, global, subScope)\n      appendChildren(node, children, scope, global, subScope)\n    }\n    return node\n  } else if (typeof ejml === 'function') {\n    res = render.eval(ejml, scope, global, subScope)\n  } else {\n    res = ejml\n  }\n  return createTextNode(res)\n}\n\nrender.eval = function evaluate (func, scope, global, subScope) {\n  try {\n    return func(scope, global, subScope || {})\n  } catch (err) {\n    return undefined\n  }\n}\n\nfunction createNode (tagName) {\n  return document.createElement(tagName)\n}\n\nfunction createTextNode (text) {\n  return document.createTextNode(text)\n}\n\nfunction createFragment () {\n  return document.createDocumentFragment()\n}\n\nfunction setAttributes (node, attributes, scope, global, subScope) {\n  let attr, val\n  Object.keys(attributes).forEach(key => {\n    if (key[0] === '@') { // event\n      subScope = subScope || {}\n      node.addEventListener(key.slice(1), (event) => {\n        subScope.$event = event\n        render.eval(attributes[key], scope, global, subScope)\n      })\n    } else {\n      attr = document.createAttribute(key)\n      val = attributes[key]\n      if (typeof val === 'function') {\n        val = render.eval(val, scope, global, subScope)\n      }\n      attr.nodeValue = val\n      node.setAttributeNode(attr)\n    }\n  })\n}\n\nfunction computedAttributes (attributes, scope, global, subScope, callback) {\n  let $if = attributes['*if']\n  if ($if) {\n    $if = render.eval($if, scope, global, subScope)\n    if (!$if) return\n  }\n  let $items = attributes['*for']\n  if ($items) {\n    $items = render.eval($items, scope, global, subScope)\n    let sub = subScope\n             ? Object.assign({}, subScope)\n             : {}\n    let subKey = attributes['_forKey']\n    ;($items || []).forEach((v, k) => {\n      sub[subKey] = v\n      sub.$index = k\n      callback(sub)\n    })\n  } else {\n    callback(scope, global, subScope)\n  }\n}\n\nfunction appendChildren (node, children, scope, global, subScope) {\n  children.forEach(child => {\n    node.appendChild(render(child, scope, global, subScope))\n  })\n}\n"],"names":["render","ejml","scope","global","subScope","res","Array","isArray","node","attributes","children","createFragment","sub","createNode","eval","createTextNode","tagName","document","createElement","text","createDocumentFragment","setAttributes","attr","val","keys","forEach","key","addEventListener","slice","event","$event","createAttribute","nodeValue","setAttributeNode","computedAttributes","callback","$if","$items","Object","assign","subKey","v","k","$index","appendChildren","appendChild","child","func","err"],"mappings":";;;;;4LAAe,SAASA,GAAQC,EAAMC,EAAOC,EAAQC,MAC/CC,aACCJ,EAEE,GAAIK,MAAMC,QAAQN,GAAO,kCACQA,GAAjCO,OAAMC,OAAeC,mBACb,MAATF,KACKG,EAAeH,KACHC,EAAYP,EAAOC,EAAQC,EAAU,SAACQ,KACxCJ,EAAME,EAAUR,EAAOC,EAAQS,SAGzCC,EAAWL,KACJA,EAAMC,EAAYP,EAAOC,EAAQC,KAChCI,EAAME,EAAUR,EAAOC,EAAQC,OAEzCI,yFACkB,kBAATP,GACVD,EAAOc,KAAKb,EAAMC,EAAOC,EAAQC,GAEjCH,SAjBA,SAmBDc,GAAeV,GAWxB,QAASQ,GAAYG,SACZC,UAASC,cAAcF,GAGhC,QAASD,GAAgBI,SAChBF,UAASF,eAAeI,GAGjC,QAASR,WACAM,UAASG,yBAGlB,QAASC,GAAeb,EAAMC,EAAYP,EAAOC,EAAQC,MACnDkB,UAAMC,gBACHC,KAAKf,GAAYgB,QAAQ,YACf,MAAXC,EAAI,MACKtB,QACNuB,iBAAiBD,EAAIE,MAAM,GAAI,SAACC,KAC1BC,OAASD,IACXf,KAAKL,EAAWiB,GAAMxB,EAAOC,EAAQC,SAGvCa,SAASc,gBAAgBL,KAC1BjB,EAAWiB,GACE,kBAARH,OACHvB,EAAOc,KAAKS,EAAKrB,EAAOC,EAAQC,MAEnC4B,UAAYT,IACZU,iBAAiBX,MAK5B,QAASY,GAAoBzB,EAAYP,EAAOC,EAAQC,EAAU+B,MAC5DC,GAAM3B,EAAW,WACjB2B,MACIpC,EAAOc,KAAKsB,EAAKlC,EAAOC,EAAQC,QAGpCiC,GAAS5B,EAAW,OACpB4B,iBACOrC,EAAOc,KAAKuB,EAAQnC,EAAOC,EAAQC,MACxCQ,GAAMR,EACCkC,OAAOC,UAAWnC,MAEzBoC,EAAS/B,EAAA,SACX4B,OAAcZ,QAAQ,SAACgB,EAAGC,KACtBF,GAAUC,IACVE,OAASD,IACJ9B,UAGFV,EAAOC,EAAQC,IAI5B,QAASwC,GAAgBpC,EAAME,EAAUR,EAAOC,EAAQC,KAC7CqB,QAAQ,cACVoB,YAAY7C,EAAO8C,EAAO5C,EAAOC,EAAQC,qRAlElDJ,EAAOc,KAAO,SAAmBiC,EAAM7C,EAAOC,EAAQC,aAE3C2C,GAAK7C,EAAOC,EAAQC,OAC3B,MAAO4C"}